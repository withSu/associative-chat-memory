# 토픽과 서브토픽 연결 시스템 - Neo4j 버전

## 설정 가이드 및 실행 방법

### 1. 필수 패키지 설치

프로젝트를 실행하기 위해 다음 패키지들을 설치해야 합니다:

```bash
pip install neo4j networkx matplotlib asyncio chromadb sentence-transformers
```

또는 아래 `requirements.txt` 파일을 사용할 수 있습니다:

```
neo4j==5.14.1
networkx==3.2.1
matplotlib==3.8.2
asyncio==3.4.3
chromadb==0.4.22
sentence-transformers==2.2.2
```

### 2. Neo4j 설치 및 설정

1. [Neo4j 다운로드 페이지](https://neo4j.com/download/)에서 Neo4j Desktop을 설치하세요.
2. Neo4j Desktop에서 새 데이터베이스를 생성합니다:
   - 데이터베이스 이름: `topic_network` (또는 원하는 이름)
   - 비밀번호: 원하는 비밀번호 설정
3. 데이터베이스를 실행하고 URI, 사용자 이름, 비밀번호를 기억해두세요.

### 3. 구현된 파일 설명

프로젝트는 다음 파일들로 구성됩니다:

1. **`enums.py`**: 열거형 정의 모듈로, 메모리 계층, 개념 유형, 연결 유형 등의 상수를 정의
2. **`memory_entry.py`**: 메모리 엔트리 데이터 모델 클래스
3. **`neo4j_config.py`**: Neo4j 설정 관리 모듈
4. **`neo4j_storage.py`**: Neo4j 그래프 데이터베이스 저장소 클래스
5. **`memory_manager_neo4j.py`**: Neo4j 기반 메모리 관리 모듈
6. **`neo4j_associative_chatbot.py`**: Neo4j 기반 실시간 연관 기억 챗봇
7. **`session.py`**: 대화 세션 관리 모듈
8. **`visualization.py`**: 네트워크 시각화 모듈
9. **`json_file_handler.py`**: JSON 파일에서 토픽/서브토픽 데이터를 로드하는 유틸리티
10. **`utils.py`**: 유틸리티 클래스 모듈 - LRUCache, BloomFilter, AssociationNetwork, LifecycleManager 구현
11. **`vector_storage.py`**: ChromaDB 기반 장기 기억 벡터 저장소
12. **`interactive_test_neo4j.py`**: Neo4j 기반 대화형 테스트 스크립트

### 4. 실행 방법

1. Neo4j 데이터베이스가 실행 중인지 확인합니다.
2. 기본 설정으로 실행:
   ```bash
   python interactive_test_neo4j.py
   ```

3. 커스텀 설정으로 실행:
   ```bash
   python interactive_test_neo4j.py --uri neo4j://localhost:7687 --user neo4j --password your_password
   ```

4. 외부 JSON 파일 사용:
   ```bash
   python interactive_test_neo4j.py -f your_data.json --uri neo4j://localhost:7687 --user neo4j --password your_password
   ```

### 5. 대화형 메뉴 사용법

프로그램을 실행하면 다음과 같은 메뉴가 표시됩니다:

```
==== 메뉴 ====
1. Neo4j에 토픽/서브토픽 관계 설정
2. 모든 연결 시각화
3. 토픽 간 연결 시각화
4. 특정 토픽 내부 연결 시각화
5. 약한 연결 찾기 및 메모리 승격
6. Neo4j 데이터베이스 통계 보기
7. JSON 데이터 보기
8. Neo4j 연결 테스트
0. 종료
```

각 메뉴 항목은 다음과 같이 작동합니다:

#### 1. Neo4j에 토픽/서브토픽 관계 설정
JSON 데이터에서 토픽과 서브토픽을 추출하여 Neo4j에 저장합니다. 다른 메뉴 항목을 사용하기 전에 반드시 이 단계를 실행해야 합니다.

#### 2. 모든 연결 시각화
모든 토픽, 서브토픽 및 그들 간의 연결을 포함한 전체 그래프를 시각화합니다. 결과는 PNG 파일로 저장되고 자동으로 열립니다.

#### 3. 토픽 간 연결 시각화
토픽 노드들과 그들 간의 연결만 시각화합니다. 서브토픽과 키워드는 표시되지 않습니다.

#### 4. 특정 토픽 내부 연결 시각화
선택한 특정 토픽과 그에 직접 연결된 서브토픽 및 키워드만 시각화합니다.

#### 5. 약한 연결 찾기 및 메모리 승격
연결 강도가 지정한 임계값 이하인 개념들을 찾아 장기 기억으로 승격시킵니다.

#### 6. Neo4j 데이터베이스 통계 보기
Neo4j 데이터베이스의 통계 정보(노드 수, 관계 수, 메모리 티어별/개념 타입별 분포 등)를 표시합니다.

#### 7. JSON 데이터 보기
현재 로드된 JSON 데이터 항목을 확인합니다.

#### 8. Neo4j 연결 테스트
Neo4j 데이터베이스 연결을 테스트합니다.

### 6. 시각화 결과 예시

시각화 결과는 다음과 같은 형태로 나타납니다:

1. **모든 연결 시각화**: 빨간색(토픽), 파란색(서브토픽), 녹색(키워드) 노드와 그들 간의 연결을 보여줍니다.
2. **토픽 간 연결 시각화**: 토픽 노드들과 그들 간의 연결만 보여줍니다.
3. **특정 토픽 내부 연결 시각화**: 선택한 토픽, 그에 연결된 서브토픽, 그리고 관련 키워드만 보여줍니다.

각 시각화에서:
- 실선은 계층적 관계(강한 연결)
- 점선은 의미적 관계(중간 강도 연결)
- 선의 두께는 연결 강도를 나타냅니다

### 7. 주의사항 및 팁

1. **Neo4j 데이터베이스 실행**: 프로그램을 실행하기 전에 Neo4j 데이터베이스가 실행 중인지 확인하세요.
2. **메뉴 순서**: 다른 메뉴를 사용하기 전에 먼저 메뉴 1(Neo4j에 토픽/서브토픽 관계 설정)을 실행해야 합니다.
3. **샘플 데이터**: 외부 JSON 파일을 지정하지 않으면 기본 샘플 데이터가 생성됩니다.
4. **한글 폰트**: 시각화에 한글이 포함된 경우, 시스템에 한글 폰트가 설치되어 있어야 합니다.
5. **ConnectionError**: Neo4j 연결 오류가 발생하면 URI, 사용자 이름, 비밀번호를 확인하고 데이터베이스가 실행 중인지 확인하세요.

### 8. 추가 개발 가이드

이 프로젝트를 확장하려면 다음 부분을 고려해 보세요:

1. **자동 키워드 추출 개선**: 현재는 메모에서 단순히 단어 길이로 키워드를 추출합니다. 이 부분을 NLP 기반 키워드 추출로 개선할 수 있습니다.
2. **웹 인터페이스 추가**: Flask/FastAPI를 사용하여 웹 기반 시각화 인터페이스를 구현할 수 있습니다.
3. **실시간 이벤트 스트림 처리**: 지속적으로 들어오는 데이터를 처리하도록 확장할 수 있습니다.
4. **다중 사용자 지원 강화**: 여러 사용자의 토픽 네트워크를 독립적으로 관리하는 기능을 추가할 수 있습니다.

이 프로젝트는 확장성을 고려하여 설계되었으므로, 필요에 따라 기능을 쉽게 추가하거나 수정할 수 있습니다.